@using MrCMS.Entities.People
@using X.PagedList
@using X.PagedList.Mvc.Core
@model MrCMS.Web.Admin.Models.PushSubscriptionSearchQuery

@{
    var results = ViewData["results"] as IPagedList<PushSubscription> ?? PagingHelper.EmptyList<PushSubscription>();
}
<form asp-controller="PushSubscription" asp-action="Index" method="get">

    <admin-header>
        <row>
            <admin-header-title title="@await Html.Resource("admin - push - subscriptions", "Push Subscriptions") "/>

            <admin-header-actions>
                <button class="btn btn-primary" type="submit">
                    Search
                </button>
            </admin-header-actions>
        </row>
    </admin-header>

    <partial name="_Query" model="Model"/>

    @if (results.TotalItemCount > 0)
    {
        <table class="table table-striped table-condensed">
            <thead>
            <tr>
                <th>
                    Subscription
                </th>
                <th>
                    Created Date
                </th>
            </tr>
            </thead>
            <tbody>
            @foreach (var result in results)
            {
                <tr>
                    <td>
                        <b>
                            @if (result.User != null)
                            {
                                <span>
                                    @result.User.Name (@result.User.Email)
                                </span>
                            }
                            else
                            {
                                <span>
                                    Anonymous
                                </span>
                            }
                        </b>
                        <br/>
                        <small>
                            @result.Endpoint
                        </small>
                    </td>
                    <td>
                        @result.CreatedOn
                    </td>

                </tr>
            }
            </tbody>
        </table>
        <hr/>
        @Html.PagedListPager(results, page => Url.Action("Index", "PushSubscription", new {page}), MrCMSPagedListRenderOptions.Bootstrap4)
    }
    else
    {
        <div class="alert alert-warning">
            Sorry, but no push subscriptions match your current search criteria
        </div>
    }
</form>